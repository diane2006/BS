<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Seguridad Pr√°ctica en Bases de Datos</title>
    <style>
        body {
            background-color: #000;
            color: #00ffff;
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 10px;
        }

        h2 {
            text-align: center;
            font-size: 18px;
            margin-bottom: 40px;
            color: #00aaaa;
        }

        .fila {
            display: flex;
            justify-content: center;
            gap: 80px;
            margin-bottom: 60px;
            flex-wrap: wrap;
            position: relative;
        }

        .fila.medio {
            justify-content: center;
            display: flex;
            flex-wrap: wrap;
            margin-top: 100px;
        }

        .nodo {
            background-color: #111;
            border: 2px solid #00ffff;
            border-radius: 12px;
            width: 130px;
            padding: 10px;
            font-size: 11px;
            text-align: center;
            opacity: 1;
            transform: scale(1);
        }

        .subtemas {
            margin-top: 6px;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .subtema {
            background-color: #222;
            border-left: 3px solid #00ffff;
            padding: 4px 6px;
            text-align: left;
            font-size: 10px;
        }

        .espacio {
            width: 130px;
            height: 30px;
        }

        .imagenes-infra {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            margin-top: 60px;
        }

        .imagenes-infra img {
            width: 80px;
            height: auto;
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        .imagenes-infra img:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }

        .lineas-svg {
            position: absolute;
            top: -70px;
            left: 0;
            width: 100%;
            height: 100px;
            pointer-events: none;
            z-index: -1;
        }

        .lineas-svg line {
            stroke: #00ffff;
            stroke-width: 2;
            stroke-dasharray: 5, 5;
        }

        .nodo.animado {
            width: 90px;
            font-size: 12px;
            padding: 6px;
            border-color: #00aaaa;
        }

        /* Estilo para el cuadro de flujo, que lo posicionamos con absolute */
        #flujo-cuadro {
            position: absolute;
            right: 20px;
            top: 220px;
            border: 2px solid #00aaaa;
            border-radius: 10px;
            padding: 12px;
            background-color: #111;
            z-index: 10;
            width: fit-content;
        }

        /* SVG container inside fila for connection line */
        #linea-conexion-svg {
            position: absolute;
            pointer-events: none;
            z-index: 5;
        }

        .block img {
            width: 16px;
            height: 16px;
        }
        
    .diagram {
      position: relative;
      width: 400px;
      height: 200px;
    }
    
    .info-box {
    position: relative;
    width: 320px;
    height: 80px;
    background: #005baa;
    color: white;
    border-radius: 8px;
    padding: 10px 10px 10px 80px; /* espacio para la imagen */
    box-sizing: border-box;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: Arial, sans-serif;
  }

  .info-box img {
    position: absolute;
    left: 10px;
    width: 60px;
    height: 60px;
    object-fit: contain;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    border-radius: 6px;
  }

  .info-box a {
    margin-left: auto;
    background: white;
    color: #005baa;
    padding: 6px 12px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  .info-box a:hover {
    background: #003f7f;
    color: white;
  }
  .mover-derecha {
  margin-left: 470px; /* mueve solo este cuadro */
}

</style>
    </style>
</head>

<body>

    <!-- Definici√≥n global del marcador de flecha -->
    <svg width="0" height="0" style="position:absolute">
        <defs>
            <marker id="flecha" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                <path d="M0,0 L0,6 L8,3 z" fill="#00ffff" />
            </marker>
        </defs>
    </svg>

    <h1>Seguridad Pr√°ctica en Bases de Datos</h1>

    <!-- Fila 1 -->
    <div class="fila">
        <div class="espacio"></div>
        <div class="nodo">
            <strong>2. Arquitectura</strong>
            <div class="subtemas">
                <div class="subtema">Estructura general de seguridad</div>
            </div>
        </div>
        <div class="espacio"></div>
    </div>
    <div class="info-box mover-derecha">
        <img src="diagrama_2.gif" alt="GIF ilustrativo" />
        <div>
            Ej: MySQL Enterprise Audit Plugin
        </div>
        <a href="Aquitectura_digram4.html">Ver diagrama</a>
    </div>

    <!-- Fila 2 -->
    <div class="fila" style="justify-content: space-between; padding: 0 120px; margin-top: -50px; position: relative;"
        id="fila2">
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
            <div class="nodo nodo-infra" id="nodo1">
                <strong>1. Infraestructura Segura</strong>
                <div class="subtemas">
                    <div class="subtema">Ubuntu Server / CentOS</div>
                    <div class="subtema">Estabilidad y seguridad</div>
                    <div class="subtema">UFW, iptables, SELinux</div>
                </div>
            </div>

            <div class="imagenes-infra">
                <svg class="lineas-svg">
                    <line id="linea1" x1="70" y1="0" x2="10" y2="80" />
                    <line id="linea2" x1="70" y1="0" x2="130" y2="80" />
                </svg>
                <img src="ubuntu.png" alt="Ubuntu" class="imagen-logo ubuntu" />
                <img src="centeos.png" alt="CentOS" class="imagen-logo centos" />
            </div>
        </div>

        <!-- Nodo 3 -->
        <div class="nodo" id="nodo3" style="align-self: flex-start; margin-left: 100px;">
            <strong>3. Componentes</strong>
            <div class="subtemas">
                <div class="subtema">Usuarios acceden v√≠a app web</div>
                <div class="subtema">WAF filtra tr√°fico malicioso</div>
                <div class="subtema">Servidor aloja motor de BD</div>
                <div class="subtema">BD devuelve resultados</div>
            </div>
        </div>

        <!-- Cuadro de flujo movido y con posici√≥n absolute -->
        <div id="flujo-cuadro">
            <div style="text-align: center; font-weight: bold; margin-bottom: 10px;">Flujo de Componentes</div>
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
                <div class="nodo animado">üë§<br /><strong>Usuario</strong></div>

                <svg width="30" height="40">
                    <line class="flujo-linea" x1="0" y1="20" x2="30" y2="20" stroke="#00ffff" stroke-width="2"
                        stroke-dasharray="5,5" marker-end="url(#flecha)" />
                </svg>

                <div class="nodo animado">üõ°Ô∏è<br /><strong>WAF</strong></div>

                <svg width="30" height="40">
                    <line class="flujo-linea" x1="0" y1="20" x2="30" y2="20" stroke="#00ffff" stroke-width="2"
                        stroke-dasharray="5,5" marker-end="url(#flecha)" />
                </svg>

                <div class="nodo animado">üñ•Ô∏è<br /><strong>Servidor</strong></div>

                <svg width="30" height="40">
                    <line class="flujo-linea" x1="0" y1="20" x2="30" y2="20" stroke="#00ffff" stroke-width="2"
                        stroke-dasharray="5,5" marker-end="url(#flecha)" />
                </svg>

                <div class="nodo animado">üíæ<br /><strong>BD</strong></div>
            </div>
        </div>

        <!-- SVG para l√≠nea de conexi√≥n desde #nodo3 al #flujo-cuadro -->
        <svg id="linea-conexion-svg" width="400" height="250" aria-hidden="true"></svg>
    </div>

    <!-- Fila 3 -->
    <!-- Fragmento fila 3 (parte importante) -->
    <div class="nodo" style="margin: 40px 20px 0 160px;">
        <strong>4. WAF y su Funci√≥n</strong>
        <div class="subtemas">
            <div class="subtema">Bloquea SQLi, XSS, endpoints</div>
            <div class="subtema">Protecci√≥n indirecta de BD</div>
            <div class="subtema">Ej: ModSecurity, Cloudflare</div>
        </div>
    </div>

    <!-- Cuadro separado para la animaci√≥n -->
    <!-- Cuadro de animaci√≥n punto 4 con dise√±o y animaci√≥n igual al cuadro de flujo del punto 3 -->
    <div <div
        style="margin: 50px 160px 20px 160px; padding: 12px; background-color: #111; border: 2px solid #00aaaa; border-radius: 12px; width: fit-content; color: #00ffff; font-size: 12px; text-align: center;">


        <strong style="font-size: 14px; color: #00aaaa; display: block; margin-bottom: 12px;">Ejemplo Visual: C√≥mo act√∫a
            el
            WAF</strong>

        <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">

            <div class="nodo animado" style="background-color: #c0392b;">
                <img src="https://img.icons8.com/ios-filled/50/ffffff/hacker.png" alt="Hacker"
                    style="width:16px; height:16px; margin-bottom: 4px;" />
                <strong>Hacker</strong><br />
                <small style="color: #ff5555;">‚ùå Bloqueado</small>
            </div>

            <svg width="30" height="40" style="overflow: visible;">
                <line class="flujo-linea" x1="0" y1="20" x2="30" y2="20" stroke="#00ffff" stroke-width="2"
                    stroke-dasharray="5,5" marker-end="url(#flecha)" />
            </svg>

            <div class="nodo animado" style="background-color: #e67e22;">
                <img src="https://cdn-icons-png.flaticon.com/512/190/190411.png" alt="WAF"
                    style="width:16px; height:16px; margin-bottom: 4px;" />
                <strong>WAF</strong>
            </div>

            <svg width="30" height="40" style="overflow: visible;">
                <line class="flujo-linea" x1="0" y1="20" x2="30" y2="20" stroke="#00ffff" stroke-width="2"
                    stroke-dasharray="5,5" marker-end="url(#flecha)" />
            </svg>

            <div class="nodo animado" style="background-color: #27ae60;">
                <img src="https://cdn-icons-png.flaticon.com/512/4248/4248443.png" alt="Base de Datos"
                    style="width:16px; height:16px; margin-bottom: 4px;" />
                <strong>Base de Datos</strong>
            </div>
        </div>
    </div>




    <!-- Fila con Auditor√≠a -->
    <div class="fila medio" style="justify-content: space-between;">
        <div class="nodo"
            style="margin: 10px 20px 0 300px; display: flex; flex-direction: column; align-items: flex-start; gap: 10px;">
            <strong>5. Auditor√≠a y Trazabilidad</strong>
            <div class="subtemas">
                <div class="subtema" style="display: flex; align-items: center; gap: 6px;">
                    Registra actividad de usuarios
                </div>
                <div class="subtema" style="display: flex; align-items: center; gap: 6px;">
                    Errores y cambios sensibles
                </div>
                <div class="subtema">
                    Usa plugins o logs nativos
                </div>
            </div>
        </div>
    </div>
    <div class="info-box">
        <img src="DIAGRAMA.gif" alt="GIF ilustrativo" />
        <div>
            Ej: MySQL Enterprise Audit Plugin
        </div>
        <a href="diagrama.html">Ver diagrama</a></div>
    <!-- Fila 4 -->
    <div class="nodo" style="width: 140px; display: flex; flex-direction: column; align-items: center; margin-left: 1090px;transform: translateY(-100px);">
            <strong>6. Trazabilidad con MySQL</strong>
            <div class="subtemas" style="margin-top: 10px;">
                <div class="subtema">Consulta ejemplo:</div>
                <div class="subtema">SELECT * FROM mysql.general_log</div>
                <div class="subtema">WHERE user_host LIKE '%usuario%'</div>
                <div class="subtema">AND argument LIKE '%DELETE%';</div>
            </div>
            <img src="https://img.icons8.com/ios-filled/50/mysql-logo.png" alt="MySQL" width="40"
                style="margin-top: 15px;" />
        </div>
    <!-- NUEVO CUADRO  ENTRE EL 6 Y 7 -->
    <div class="fila medio" style="justify-content: space-between; margin-top: 40px;">
        <div class="nodo"
            style="margin: 10px 20px 0 300px; display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-color:#00ffff; transform: translateY(60px);">
            <strong>7. Herramientas y funciones</strong>
            <div class="subtemas">
                <div class="subtema">MySQL Enterprise Audit Plugin (de pago, pero hay alternativas).</div>
                <div class="subtema">Percona Server for MySQL + audit_log plugin (gratuito).</div>
                <div class="subtema">Uso de general_log y slow_query_log para monitoreo b√°sico.</div>
            </div>
        </div>
    </div>
    <div class="info-box">
        <img src="diagrama_2.gif" alt="GIF ilustrativo" />
        <div>
            Ej: MySQL Enterprise Audit Plugin
        </div>
        <a href="diagrama_2.html">Ver diagrama</a>
    </div>
        <div class="nodo" style="width: 140px; display: flex; flex-direction: column; align-items: center;margin-left: 1100px; transform: translateY(-180px);">
            <strong>8. Percona Toolkit</strong>
            <div class="subtemas" style="margin-top: 10px;">
                <div class="subtema">pt-query-digest (auditor√≠a)</div>
                <div class="subtema">pt-table-checksum (comparaci√≥n)</div>
                <div class="subtema">Consulta lenta / replicaci√≥n</div>
            </div>
        </div>
        <div class="info-box">
            <img src="diagrama_2.gif" alt="GIF ilustrativo" />
            <div>
                Ej: PERCONA Toolkit
            </div>
            <a href="diagrama_3.html">Ver diagrama</a>
            </div>
        <div class="nodo" style="width: 140px; display: flex; flex-direction: column; align-items: center;">
            <strong>9. Resumen Final</strong>
            <div class="subtemas" style="margin-top: 10px;">
                <div class="subtema">Usar sistemas s√≥lidos y WAF</div>
                <div class="subtema">Monitoreo con auditor√≠a</div>
                <div class="subtema">Respaldos frecuentes</div>
            </div>
            <img src="https://img.icons8.com/ios-filled/50/summary.png" alt="Resumen" width="40"
                style="margin-top: 15px;" />
        </div>
    
    </div>

    <script>
        const ubuntu = document.querySelector(".ubuntu");
        const centos = document.querySelector(".centos");

        // Animaci√≥n JS de las l√≠neas punteadas en infraestructura
        const lineasInfra = [document.getElementById("linea1"), document.getElementById("linea2")];
        let offsetInfra = 0;

        function animarLineasInfra() {
            offsetInfra = (offsetInfra + 1) % 10;
            lineasInfra.forEach(line => {
                line.setAttribute("stroke-dashoffset", offsetInfra);
            });
            requestAnimationFrame(animarLineasInfra);
        }

        animarLineasInfra();

        // Animaci√≥n JS para l√≠neas punteadas del flujo de componentes (l√≠neas nuevas)
        const lineasFlujoGlobal = [];

        const animaLineasFlujo = () => {
            lineasFlujoGlobal.forEach(line => {
                const currentOffset = parseFloat(line.getAttribute('stroke-dashoffset')) || 0;
                const newOffset = (currentOffset + 0.5) % 10;
                line.setAttribute('stroke-dashoffset', newOffset);
            });
            requestAnimationFrame(animaLineasFlujo);
        };

        // Crear la l√≠nea de conexi√≥n desde el nodo 3 al flujo cuadro
        function crearLineaConexion() {
            const contenedor = document.getElementById('fila2');
            const nodo3 = document.getElementById('nodo3');
            const flujoCuadro = document.getElementById('flujo-cuadro');
            const svgLinea = document.getElementById('linea-conexion-svg');

            // Obtener posiciones relativas dentro contenedor (fila2)
            const contRect = contenedor.getBoundingClientRect();
            const nodo3Rect = nodo3.getBoundingClientRect();
            const flujoRect = flujoCuadro.getBoundingClientRect();

            // Calcular posiciones relativas a contenedor
            const startX = nodo3Rect.left + nodo3Rect.width / 2 - contRect.left;
            const startY = nodo3Rect.bottom - contRect.top;

            const endX = flujoRect.left - contRect.left; // left edge of flujo cuadro inside contenedor
            const endY = flujoRect.top - contRect.top + 20; // a bit lower in flujo cuadro

            // Redimensionar svg para cubrir el √°rea necesaria
            const widthSvg = contRect.width;
            const heightSvg = contRect.height;

            svgLinea.setAttribute('width', widthSvg);
            svgLinea.setAttribute('height', heightSvg);
            svgLinea.style.top = 0;
            svgLinea.style.left = 0;

            // Limpiar contenido anterior
            while (svgLinea.firstChild) {
                svgLinea.removeChild(svgLinea.firstChild);
            }

            // Crear l√≠nea vertical desde nodo3 center-bottom downward a aligned height with flujo cuadro top
            const ns = "http://www.w3.org/2000/svg";

            // Group of two lines with dashed stroke
            const lineVertical = document.createElementNS(ns, 'line');
            lineVertical.setAttribute('x1', startX);
            lineVertical.setAttribute('y1', startY);
            lineVertical.setAttribute('x2', startX);
            lineVertical.setAttribute('y2', endY);
            lineVertical.setAttribute('stroke', '#00ffff');
            lineVertical.setAttribute('stroke-width', '2');
            lineVertical.setAttribute('stroke-dasharray', '5,5');
            svgLinea.appendChild(lineVertical);

            // Horizontal line from bottom of vertical line to left edge of flujo-cuadro
            const lineHorizontal = document.createElementNS(ns, 'line');
            lineHorizontal.setAttribute('x1', startX);
            lineHorizontal.setAttribute('y1', endY);
            lineHorizontal.setAttribute('x2', endX);
            lineHorizontal.setAttribute('y2', endY);
            lineHorizontal.setAttribute('stroke', '#00ffff');
            lineHorizontal.setAttribute('stroke-width', '2');
            lineHorizontal.setAttribute('stroke-dasharray', '5,5');
            svgLinea.appendChild(lineHorizontal);

            lineasFlujoGlobal.push(lineVertical, lineHorizontal);
        }

        window.addEventListener('resize', () => {
            crearLineaConexion();
        });

        window.addEventListener('load', () => {
            crearLineaConexion();
            animaLineasFlujo();
            // Animate the flow chart lines
            const flujoLines = document.querySelectorAll('.flujo-linea');
            flujoLines.forEach(line => {
                line.setAttribute('stroke-dashoffset', '0'); // Reset offset
                animateFlowLine(line);
            });
        });

        function animateFlowLine(line) {
            let offset = 0;
            function animate() {
                offset = (offset + 0.5) % 10; // Increment offset
                line.setAttribute('stroke-dashoffset', offset);
                requestAnimationFrame(animate);
            }
            animate();

            const arrow1 = document.getElementById("arrow1");
            const arrow2 = document.getElementById("arrow2");
            let toggle = true;
            setInterval(() => {
                arrow1.classList.toggle("animated", toggle);
                arrow2.classList.toggle("animated", !toggle);
                toggle = !toggle;
            }, 600);

        }
         // Animar la aparici√≥n de los cuadros uno a uno
            const boxes = document.querySelectorAll('.box');
            boxes.forEach((box, i) => {
                setTimeout(() => {
                    box.classList.add('visible');
                }, 500 * (i + 1));
            });
    </script>

</body>

</html>
